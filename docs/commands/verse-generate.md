# verse-generate

Orchestrate image and audio generation for specific verses in a collection.

## Synopsis

```bash
verse-generate --collection COLLECTION --verse N [OPTIONS]
```

## Description

The `verse-generate` command orchestrates the generation of multimedia content for specific verses. It can:
- Generate images using DALL-E 3
- Generate audio pronunciations using ElevenLabs
- Generate both image and audio in a single command

This command requires that verse files already exist in your collection.

## Options

### Required

- `--collection NAME` - Collection key (e.g., `hanuman-chalisa`, `sundar-kaand`)
- `--verse N` - Verse number or identifier

### Optional

- `--all` - Generate both image and audio
- `--image` - Generate only image
- `--audio` - Generate only audio
- `--theme NAME` - Image theme name (default: modern-minimalist)
- `--list-collections` - List all available collections

## Examples

### List Available Collections

```bash
verse-generate --list-collections
```

### Generate Everything (Recommended)

Generate both image and audio for a verse:

```bash
verse-generate --collection hanuman-chalisa --verse 15 --all --theme modern-minimalist
```

This automatically generates:
- DALL-E 3 image
- Full-speed audio pronunciation
- Slow-speed audio pronunciation (0.75x)

### Generate Specific Components

```bash
# Only image
verse-generate --collection sundar-kaand --verse 3 --image --theme modern-minimalist

# Only audio
verse-generate --collection sankat-mochan-hanumanashtak --verse 5 --audio

# Image and audio with specific theme
verse-generate --collection hanuman-chalisa --verse 20 --all --theme kids-friendly
```

### Different Collections

```bash
# Hanuman Chalisa
verse-generate --collection hanuman-chalisa --verse 12 --all

# Sundar Kaand (using custom verse identifier)
verse-generate --collection sundar-kaand --verse chaupai_03 --all

# Sankat Mochan Hanumanashtak
verse-generate --collection sankat-mochan-hanumanashtak --verse 7 --all
```

## Generated Files

When using `--all`, the command creates:

1. **Image**: `images/<collection-key>/<theme-name>/verse-NN.png`
   - Generated by DALL-E 3
   - Portrait format (1024x1792)
   - Styled according to theme configuration

2. **Audio files**: `audio/<collection-key>/verse_NN_*.mp3`
   - `verse_NN_full.mp3` - Full speed
   - `verse_NN_slow.mp3` - Slow speed (0.75x)

## Workflow

```bash
# 1. List available collections
verse-generate --list-collections

# 2. Generate everything for a verse
verse-generate --collection hanuman-chalisa --verse 15 --all --theme modern-minimalist

# 3. Review generated files
open images/hanuman-chalisa/modern-minimalist/verse-15.png
afplay audio/hanuman-chalisa/verse_15_full.mp3

# 4. Commit
git add images/ audio/
git commit -m "Add media for Hanuman Chalisa verse 15"
```

### Regenerate Specific Components

```bash
# Regenerate just the image
verse-generate --collection hanuman-chalisa --verse 15 --image --theme modern-minimalist

# Regenerate just the audio
verse-generate --collection hanuman-chalisa --verse 15 --audio
```

## Requirements

- **For --image**: `OPENAI_API_KEY` + scene description in `docs/image-prompts/<collection-key>.md` + theme config in `docs/themes/<collection-key>/<theme-name>.yml`
- **For --audio**: `ELEVENLABS_API_KEY` + verse file with `devanagari:` field
- Collection must be enabled in `_data/collections.yml`

## Notes

- Verse files must already exist in `_verses/<collection-key>/`
- Scene descriptions must exist in `docs/image-prompts/<collection-key>.md`
- Theme configuration must exist in `docs/themes/<collection-key>/<theme-name>.yml`
- Audio generation reads from the `devanagari:` field in verse files
- Only enabled collections (in `collections.yml`) can be processed

## See Also

- [verse-images](verse-images.md) - Image generation details
- [verse-audio](verse-audio.md) - Audio generation details
- [Troubleshooting](../troubleshooting.md) - Common issues
